<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Viraly</title>
<style>
:root {
  --cream: #faf6f1;
  --cream-2: #f3ede5;
  --cream-3: #ebe4d9;
  --white: #ffffff;
  --border: rgba(0,0,0,0.07);
  --border-h: rgba(0,0,0,0.12);
  --text: #1a1a1a;
  --text-2: #6b6b6b;
  --text-3: #9a9a9a;
  --green: #2d8a4e;
  --green-bg: #e8f5ed;
  --red: #c0392b;
  --red-bg: #fde8e8;
  --peach: #f5d6c3;
  --peach-dark: #d4875e;
  --lavender: #e5dff5;
  --lavender-dark: #7c6bbd;
  --mint: #d4f0e0;
  --mint-dark: #3a9e6a;
  --radius: 16px;
  --radius-sm: 12px;
  --radius-xs: 8px;
}
* { margin:0; padding:0; box-sizing:border-box; }
html, body { height:100%; }
body {
  background: var(--cream);
  color: var(--text);
  font-family: Helvetica, Arial, sans-serif;
  display: flex;
  overflow: hidden;
}

.sidebar {
  width: 72px; flex-shrink: 0;
  background: var(--white);
  border-right: 1px solid var(--border);
  display: flex; flex-direction: column; align-items: center;
  padding: 20px 0; gap: 6px;
}
.sb-logo {
  width: 40px; height: 40px; background: var(--text);
  border-radius: var(--radius-xs);
  display: flex; align-items: center; justify-content: center;
  margin-bottom: 24px;
}
.sb-logo svg { width:20px; height:20px; color:#fff; }
.sb-item {
  width: 44px; height: 44px; border-radius: var(--radius-sm);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; transition: all 0.2s; color: var(--text-3);
}
.sb-item:hover { background: var(--cream); color: var(--text-2); }
.sb-item.active { background: var(--cream-2); color: var(--text); }
.sb-item svg { width:20px; height:20px; }
.sb-spacer { flex:1; }
.sb-avatar {
  width: 36px; height: 36px; border-radius: 50%;
  background: linear-gradient(135deg, var(--peach), var(--lavender));
  display: flex; align-items: center; justify-content: center;
  font-size: 14px; font-weight: 600; color: var(--text);
}

.main { flex: 1; display: flex; overflow: hidden; }

.center {
  flex: 1; overflow-y: auto;
  padding: 32px 36px 60px;
}
.center::-webkit-scrollbar { width:6px; }
.center::-webkit-scrollbar-thumb { background:var(--cream-3); border-radius:3px; }

.page-title { font-size: 28px; font-weight: 700; letter-spacing: -0.5px; margin-bottom: 4px; }
.page-sub { font-size: 14px; color: var(--text-3); margin-bottom: 28px; }

.section-title {
  font-size: 13px; font-weight: 600; color: var(--text-2);
  text-transform: uppercase; letter-spacing: 0.8px; margin-bottom: 14px;
}

/* ‚îÄ‚îÄ AI SECTION (hero) ‚îÄ‚îÄ */
.ai-section {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  margin-bottom: 28px;
}
.ai-header {
  padding: 18px 24px;
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
}
.ai-title { font-size: 14px; font-weight: 700; color: var(--text); }
.ai-live {
  display: flex; align-items: center; gap: 6px;
  font-size: 11px; font-weight: 600; color: var(--green);
}
.ai-live-dot { width:6px; height:6px; border-radius:50%; background:var(--green); animation:blink 2s infinite; }
@keyframes blink { 0%,100%{opacity:1}50%{opacity:0.3} }

.ai-prompt-area {
  padding: 28px 24px;
  background: var(--cream);
  border-bottom: 1px solid var(--border);
}
.ai-prompt-label {
  font-size: 12px; font-weight: 600; color: var(--text-2);
  text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 12px;
}
.ai-textarea {
  width: 100%; min-height: 160px;
  background: var(--white);
  border: 1.5px dashed var(--border-h);
  border-radius: var(--radius);
  font-family: Helvetica, Arial, sans-serif;
  font-size: 15px; color: var(--text);
  padding: 20px; resize: vertical; line-height: 1.6;
  transition: border-color 0.2s;
}
.ai-textarea:focus { outline:none; border-color: var(--text-3); border-style: solid; }
.ai-textarea::placeholder { color: var(--text-3); font-size: 14px; }
.ai-prompt-footer {
  display: flex; align-items: center; justify-content: space-between;
  margin-top: 14px;
}
.ai-send {
  padding: 12px 32px; background: var(--text); color: var(--white);
  font-family: Helvetica, Arial, sans-serif;
  font-size: 13px; font-weight: 600;
  border: none; border-radius: var(--radius-sm);
  cursor: pointer; transition: all 0.2s;
}
.ai-send:hover { opacity:0.85; }
.ai-send:disabled { opacity:0.3; cursor:not-allowed; }
.ai-hint { font-size: 11px; color: var(--text-3); }

.ai-chips {
  display: flex; gap: 8px; flex-wrap: wrap;
  padding: 16px 24px; border-bottom: 1px solid var(--border);
}
.chip {
  padding: 8px 18px; background: var(--cream);
  border: 1px solid var(--border); border-radius: 20px;
  font-size: 12px; font-weight: 500; color: var(--text-2);
  cursor: pointer; transition: all 0.2s;
  font-family: Helvetica, Arial, sans-serif;
}
.chip:hover { border-color: var(--text-3); color: var(--text); background: var(--cream-2); }

.ai-body { padding: 24px; min-height: 60px; }
.ai-placeholder { font-size: 13px; color: var(--text-3); line-height: 1.6; text-align:center; padding: 20px 0; }
.ai-loading { display:none; padding:40px 24px; text-align:center; }
.ai-loading.on { display:block; }
.ai-spinner {
  width:24px;height:24px;border:2.5px solid var(--cream-3);border-top-color:var(--text);
  border-radius:50%;animation:spin .7s linear infinite;margin:0 auto 12px;
}
@keyframes spin { to{transform:rotate(360deg)} }
.ai-loading-text { font-size:12px; color:var(--text-3); animation:pulse 1.5s ease infinite; }
@keyframes pulse { 0%,100%{opacity:1}50%{opacity:0.4} }

.ai-result { display:none; }
.ai-result.on { display:block; }
.ai-result-body { font-size: 14px; line-height: 1.8; color: var(--text-2); }
.ai-result-body h2 {
  font-size: 16px; font-weight: 700; color: var(--text);
  margin: 22px 0 8px; padding-bottom: 6px;
  border-bottom: 1px solid var(--border);
}
.ai-result-body h2:first-child { margin-top:0; }
.ai-result-body h3 { font-size: 14px; font-weight: 600; color: var(--peach-dark); margin: 16px 0 4px; }
.ai-result-body p { margin-bottom: 8px; }
.ai-result-body strong { color: var(--text); }
.ai-result-body em { color: var(--lavender-dark); font-style: normal; }
.ai-result-body ul, .ai-result-body ol { margin: 8px 0 14px 18px; }
.ai-result-body li { margin-bottom: 4px; }
.ai-result-body code {
  background: var(--cream-2); padding: 2px 6px; border-radius: 4px;
  font-size: 12px; color: var(--peach-dark);
}
.ai-error {
  display:none; padding: 12px 24px;
  font-size: 12px; color: var(--red); background: var(--red-bg);
}
.ai-error.on { display:block; }

/* ‚îÄ‚îÄ POST CARDS ‚îÄ‚îÄ */
.posts-grid {
  display: grid; grid-template-columns: repeat(3, 1fr);
  gap: 14px; margin-bottom: 28px;
}
.post-card {
  border: 1px solid var(--border); border-radius: var(--radius);
  padding: 20px; transition: box-shadow 0.2s; position: relative;
}
.post-card:hover { box-shadow: 0 2px 12px rgba(0,0,0,0.04); }
.post-card:nth-child(1) { background: var(--mint); }
.post-card:nth-child(2) { background: var(--lavender); }
.post-card:nth-child(3) { background: var(--peach); }
.pc-badge {
  display: inline-block; font-size: 10px; font-weight: 700;
  text-transform: uppercase; letter-spacing: 0.5px;
  padding: 3px 10px; border-radius: 20px; margin-bottom: 12px;
}
.post-card:nth-child(1) .pc-badge { background: rgba(255,255,255,0.6); color: var(--mint-dark); }
.post-card:nth-child(2) .pc-badge { background: rgba(255,255,255,0.6); color: var(--lavender-dark); }
.post-card:nth-child(3) .pc-badge { background: rgba(255,255,255,0.6); color: var(--peach-dark); }
.pc-caption {
  font-size: 14px; font-weight: 600; line-height: 1.4; margin-bottom: 14px;
  display: -webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden;
}
.pc-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 6px 16px; }
.pc-stat-label { font-size: 11px; color: rgba(0,0,0,0.4); }
.pc-stat-value { font-size: 13px; font-weight: 600; }

/* ‚îÄ‚îÄ RIGHT PANEL ‚îÄ‚îÄ */
.right-panel {
  width: 280px; flex-shrink: 0;
  background: var(--white);
  border-left: 1px solid var(--border);
  overflow-y: auto; padding: 28px 22px;
}
.right-panel::-webkit-scrollbar { width:4px; }
.right-panel::-webkit-scrollbar-thumb { background:var(--cream-3); border-radius:2px; }

.rp-profile { text-align: center; margin-bottom: 24px; }
.rp-avatar {
  width: 64px; height: 64px; border-radius: 50%;
  background: linear-gradient(135deg, var(--peach), var(--lavender));
  margin: 0 auto 12px;
  display: flex; align-items: center; justify-content: center;
  font-size: 26px; font-weight: 700; color: var(--text);
}
.rp-name { font-size: 16px; font-weight: 700; margin-bottom: 2px; }
.rp-handle { font-size: 13px; color: var(--text-3); }

.rp-section-title {
  font-size: 11px; font-weight: 600; color: var(--text-3);
  text-transform: uppercase; letter-spacing: 0.8px; margin: 20px 0 12px;
}
.rp-row {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 0; border-bottom: 1px solid var(--border);
}
.rp-row:last-child { border-bottom: none; }
.rp-row-label { font-size: 13px; color: var(--text); }
.rp-row-value { font-size: 13px; font-weight: 600; display: flex; align-items: center; gap: 4px; }
.rp-arrow { color: var(--green); font-size: 12px; }
.rp-chevron { color: var(--text-3); font-size: 14px; }

.rp-tools-list { list-style: none; }
.rp-tool {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 0; border-bottom: 1px solid var(--border);
  font-size: 13px; color: var(--text-2); cursor: pointer; transition: color 0.2s;
}
.rp-tool:last-child { border-bottom: none; }
.rp-tool:hover { color: var(--text); }
.rp-tool-icon { font-size: 16px; width: 22px; text-align: center; }
.rp-tool-chevron { margin-left: auto; color: var(--text-3); font-size: 14px; }

@media(max-width:1100px) { .right-panel { display:none; } }
@media(max-width:768px) {
  .sidebar { display:none; }
  .posts-grid { grid-template-columns: 1fr; }
  .center { padding: 20px; }
}
</style>
</head>
<body>

<aside class="sidebar">
  <div class="sb-logo"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M15 3l-6 18"/><path d="M4 8h16"/></svg></div>
  <div class="sb-item active"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/></svg></div>
  <div class="sb-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg></div>
  <div class="sb-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg></div>
  <div class="sb-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div>
  <div class="sb-spacer"></div>
  <div class="sb-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="3"/><path d="M12 1v2m0 18v2m-9-11h2m18 0h2m-3.3-6.7l-1.4 1.4M4.7 19.3l-1.4 1.4m0-15.4l1.4 1.4m14.2 14.2l1.4 1.4"/></svg></div>
  <div class="sb-avatar">F</div>
</aside>

<div class="main">
  <div class="center">
    <div class="page-title">Viraly</div>
    <div class="page-sub">AI-powered content diagnostics</div>

    <!-- AI PROMPT (hero section) -->
    <div class="ai-section">
      <div class="ai-header">
        <div class="ai-title">AI Strategist</div>
        <div class="ai-live"><div class="ai-live-dot"></div> Ready</div>
      </div>
      <div class="ai-prompt-area">
        <div class="ai-prompt-label">What do you want to know?</div>
        <textarea class="ai-textarea" id="prompt" placeholder="Paste your content, describe your goals, or ask a question about your analytics‚Ä¶&#10;&#10;Examples:&#10;‚Ä¢ Why did my viral post outperform the others?&#10;‚Ä¢ Write me 3 scripts based on what's working&#10;‚Ä¢ How can I improve my underperforming content?" rows="6"></textarea>
        <div class="ai-prompt-footer">
          <div class="ai-hint">Ctrl + Enter to send</div>
          <button class="ai-send" id="btn" onclick="send()">Analyze</button>
        </div>
      </div>
      <div class="ai-chips">
        <button class="chip" onclick="go('Give me a full content analysis with diagnosis and 3 new scripts')">Full Analysis</button>
        <button class="chip" onclick="go('Write 5 new video scripts based on what works')">Generate Scripts</button>
        <button class="chip" onclick="go('Why did Post 2 go viral and Post 1 flop?')">Viral Breakdown</button>
        <button class="chip" onclick="go('How could I fix Post 1 to perform better?')">Fix Underperformers</button>
      </div>
      <div class="ai-error" id="err"></div>
      <div class="ai-loading" id="loading">
        <div class="ai-spinner"></div>
        <div class="ai-loading-text" id="ltxt">Analyzing content patterns‚Ä¶</div>
      </div>
      <div class="ai-result" id="results">
        <div class="ai-body"><div class="ai-result-body" id="rbox"></div></div>
      </div>
      <div id="placeholder-body">
        <div class="ai-body">
          <div class="ai-placeholder">Select a quick action or type your own question to get personalized content strategy insights and script ideas.</div>
        </div>
      </div>
    </div>

    <!-- Posts -->
    <div class="section-title">Recent Posts</div>
    <div class="posts-grid">
      <div class="post-card">
        <div class="pc-badge">üî• Viral ‚Äî 5.1M views</div>
        <div class="pc-caption">"us continuing to beat our dead horses into 2026"</div>
        <div class="pc-stats">
          <div><div class="pc-stat-label">Likes</div><div class="pc-stat-value">443,973</div></div>
          <div><div class="pc-stat-label">Shares</div><div class="pc-stat-value">69,684</div></div>
          <div><div class="pc-stat-label">Saves</div><div class="pc-stat-value">66,070</div></div>
          <div><div class="pc-stat-label">Skip Rate</div><div class="pc-stat-value">31.1%</div></div>
        </div>
      </div>
      <div class="post-card">
        <div class="pc-badge">üìà Mid ‚Äî 337K views</div>
        <div class="pc-caption">"always beating that damn horse. üò≠"</div>
        <div class="pc-stats">
          <div><div class="pc-stat-label">Likes</div><div class="pc-stat-value">30,180</div></div>
          <div><div class="pc-stat-label">Shares</div><div class="pc-stat-value">13,527</div></div>
          <div><div class="pc-stat-label">Saves</div><div class="pc-stat-value">517</div></div>
          <div><div class="pc-stat-label">Skip Rate</div><div class="pc-stat-value">47.6%</div></div>
        </div>
      </div>
      <div class="post-card">
        <div class="pc-badge">üìâ Low ‚Äî 30K views</div>
        <div class="pc-caption">"wanted to post this video here as appreciation..."</div>
        <div class="pc-stats">
          <div><div class="pc-stat-label">Likes</div><div class="pc-stat-value">1,125</div></div>
          <div><div class="pc-stat-label">Shares</div><div class="pc-stat-value">382</div></div>
          <div><div class="pc-stat-label">Saves</div><div class="pc-stat-value">237</div></div>
          <div><div class="pc-stat-label">Skip Rate</div><div class="pc-stat-value">47.9%</div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- RIGHT PANEL -->
  <div class="right-panel">
    <div class="rp-profile">
      <div class="rp-avatar">F</div>
      <div class="rp-name">Fiori</div>
      <div class="rp-handle">@fiori</div>
    </div>

    <div class="rp-section-title">Insights ¬∑ Jan 21 ‚Äì Feb 19</div>
    <div>
      <div class="rp-row"><div class="rp-row-label">Views</div><div class="rp-row-value"><span class="rp-arrow">‚Üó</span> 6.1M <span class="rp-chevron">‚Ä∫</span></div></div>
      <div class="rp-row"><div class="rp-row-label">Interactions</div><div class="rp-row-value"><span class="rp-arrow">‚Üó</span> 794.0K <span class="rp-chevron">‚Ä∫</span></div></div>
      <div class="rp-row"><div class="rp-row-label">New followers</div><div class="rp-row-value"><span class="rp-arrow">‚Üó</span> 1.4K <span class="rp-chevron">‚Ä∫</span></div></div>
      <div class="rp-row"><div class="rp-row-label">Content shared</div><div class="rp-row-value">22 <span class="rp-chevron">‚Ä∫</span></div></div>
    </div>

    <div class="rp-section-title">Your tools</div>
    <ul class="rp-tools-list">
      <li class="rp-tool"><span class="rp-tool-icon">‚è±</span> Monthly recap <span class="rp-tool-chevron">‚Ä∫</span></li>
      <li class="rp-tool"><span class="rp-tool-icon">‚ú¶</span> Best practices <span class="rp-tool-chevron">‚Ä∫</span></li>
      <li class="rp-tool"><span class="rp-tool-icon">üí°</span> Inspiration <span class="rp-tool-chevron">‚Ä∫</span></li>
      <li class="rp-tool"><span class="rp-tool-icon">üìä</span> Analytics deep dive <span class="rp-tool-chevron">‚Ä∫</span></li>
      <li class="rp-tool"><span class="rp-tool-icon">üé¨</span> Script vault <span class="rp-tool-chevron">‚Ä∫</span></li>
    </ul>
  </div>
</div>

<script>
const BACKEND_URL = 'https://samashah.app.n8n.cloud/webhook/6db5c0be-ed26-4c7a-a8d2-ace0a7aff752';

function go(t) { document.getElementById('prompt').value = t; send(); }

const LMSGS = ["Analyzing content patterns‚Ä¶","Comparing engagement signals‚Ä¶","Mining share-to-comment ratios‚Ä¶","Generating strategic insights‚Ä¶","Crafting scripts‚Ä¶"];

function md(t) {
  return t
    .replace(/### (.*)/g,'<h3>$1</h3>')
    .replace(/## (.*)/g,'<h2>$1</h2>')
    .replace(/# (.*)/g,'<h2>$1</h2>')
    .replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>')
    .replace(/\*(.*?)\*/g,'<em>$1</em>')
    .replace(/`(.*?)`/g,'<code>$1</code>')
    .replace(/^- (.*)/gm,'<li>$1</li>')
    .replace(/^(\d+)\. (.*)/gm,'<li>$2</li>')
    .replace(/\n\n/g,'</p><p>')
    .replace(/\n/g,'<br>');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FALLBACK RESPONSES ‚Äî data-driven analysis
// served when backend is unreachable
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const FALLBACK_FULL = `## Performance Diagnosis

Across 3 posts, there's a **165x variance** between your lowest performer (30.8K views) and your viral hit (5.1M views). That's not random ‚Äî there's a clear content-type signal buried in the data.

**The pattern:** Humor and relatable friendship content outperforms sentimental/appreciation content by a factor of **10‚Äì165x**. Both "dead horse" posts (Post 2 and Post 3) crushed it. The appreciation post (Post 1) flatlined.

## Key Metrics Breakdown

**Share-to-Comment Ratio** ‚Äî this is your virality fingerprint:
- Post 2 (viral): **43.5:1** ‚Äî massively shareable, people sent this to friends instead of commenting
- Post 3 (mid): **795:1** ‚Äî same pattern but even more extreme
- Post 1 (low): **9.8:1** ‚Äî lower shareability, more passive engagement

**Skip Rate vs. Your Average (59.1%):**
- Post 2: **31.1%** ‚Äî 28 points below your average. People stopped scrolling.
- Post 3: **47.6%** ‚Äî still 11 points below average. Solid hook.
- Post 1: **47.9%** ‚Äî better than average but watch time collapsed (8 sec of 23 sec = 34% retention)

**Algorithm Distribution:**
- Post 2 reached **99.3% non-followers** ‚Äî the algorithm pushed this hard to Explore/Reels
- Post 3 reached **99.1% non-followers** ‚Äî same signal
- Post 1 stayed mostly within your existing audience

## What's Working

- **Humor-first hooks** ‚Äî casual, self-aware, slightly absurd captions that make people feel "seen"
- **The "dead horse" franchise** ‚Äî you've accidentally built a recurring bit. Post 3 (337K) primed the audience, Post 2 (5.1M) paid it off. Callback humor compounds.
- **Share mechanics** ‚Äî your viral content triggers the "tag your friend / send this to someone" impulse. 69K shares on Post 2 is the engine behind 5.1M views.
- **Short-to-mid duration** ‚Äî your best content is 7‚Äì32 seconds. Long enough to land the joke, short enough to rewatch.

## What's Not Working

- **Sentimental hooks** ‚Äî "wanted to post this as appreciation" signals low-energy, diary-style content. The algorithm reads this as low-intent and suppresses distribution.
- **23-second sentimental content** ‚Äî viewers gave it 8 seconds (34% retention). The concept didn't earn its length.
- **Low save rate on Post 1** (237 saves) ‚Äî nobody bookmarked it. Saves signal value to the algorithm, and this content didn't deliver utility or rewatchability.

## 3 New Scripts

### Script 1: "The Dead Horse Extended Universe"
**Hook (first 3 sec):** Text overlay ‚Äî *"the horse when we show up for the 4th time"*
**Concept:** Cut between you and friends acting out increasingly absurd "beating the dead horse" scenarios ‚Äî graduation, job interview, wedding speech
**Caption:** "at this point the horse is filing a restraining order"
**Duration:** 15‚Äì20 sec
**Why:** Franchise content with built-in audience. Post 2 proved the ceiling is 5M+. Lean in.

### Script 2: "Friendship Red Flags That Are Actually Green Flags"
**Hook (first 3 sec):** Text overlay ‚Äî *"things my friends do that would be unhinged if we weren't this close"*
**Concept:** Quick cuts of relatable "only best friends" moments ‚Äî reading each other's texts, brutally honest outfit reviews, showing up unannounced
**Caption:** "if you don't have friends like this, I'm sorry üò≠"
**Duration:** 20‚Äì25 sec
**Why:** Same relatable/humor niche as your viral hit. High share trigger ("tag your bestie"). Targets the 99% non-follower discovery feed.

### Script 3: "College Lore Nobody Talks About"
**Hook (first 3 sec):** Text overlay ‚Äî *"college experiences that feel made up but every student has had"*
**Concept:** Rapid-fire relatable college moments ‚Äî the 8am class you never went to, the dining hall friendship, the professor who changed your life
**Caption:** "college was a fever dream and we all just collectively agreed to not talk about it"
**Duration:** 15‚Äì20 sec
**Why:** Bridges your college niche into humor format. Post 1 proved college content alone doesn't work ‚Äî but college content + humor + relatability hits the same triggers as your 5.1M post.

## 30-Day Strategy

**Week 1‚Äì2:** Post 2 more "dead horse" sequels while the franchise is hot. Space them 4‚Äì5 days apart. Vary the format each time (POV, skit, text-over-clips).

**Week 3‚Äì4:** Introduce 2 new recurring formats ‚Äî "friendship red flags" and "college lore." Test which one gets the share ratio above 10:1.

**Posting cadence:** 4‚Äì5 reels per week. Prioritize humor/relatable (80%), sprinkle in 1 personal/appreciation post per 2 weeks max (20%) ‚Äî but repackage it with a hook that earns attention.

**Golden rule:** If the caption doesn't make someone want to send it to a friend, rewrite it.`;

const FALLBACK_SCRIPTS = `## 5 New Video Scripts

Based on your data, humor + relatability + friendship drives everything. Your viral post (5.1M views) had a 43:1 share-to-comment ratio ‚Äî people send your content more than they comment on it. Every script below is designed to trigger that same "send to your group chat" impulse.

### Script 1: "The Dead Horse: Origins"
**Hook:** *"how the horse got here in the first place"*
**Concept:** Fake dramatic "origin story" of the dead horse bit ‚Äî trailer-style voiceover, epic music, completely mundane friendship moments
**Caption:** "every cinematic universe needs a prequel"
**Duration:** 20‚Äì25 sec
**Why:** Your "dead horse" franchise went from 337K ‚Üí 5.1M. A prequel plays on the existing momentum and rewards returning viewers.

### Script 2: "Texts That Would Destroy Us If Leaked"
**Hook:** *"screenshots our friendship would not survive if these got out"*
**Concept:** Phone screen recordings scrolling through genuinely unhinged (but relatable) friend group chat messages ‚Äî blurred enough to be mysterious, clear enough to be funny
**Caption:** "our group chat is a federal crime at this point"
**Duration:** 15‚Äì20 sec
**Why:** Ultra-shareable concept. People tag friends and send to group chats. Targets the same share mechanic that drove 69K shares on Post 2.

### Script 3: "Things We Gaslight Each Other About"
**Hook:** *"things my friends swear happened that I have zero memory of"*
**Concept:** Back-and-forth POV of friends telling wildly different versions of the same story ‚Äî one remembers it one way, the other completely differently
**Caption:** "somebody is lying and at this point we'll never know who üò≠"
**Duration:** 20‚Äì30 sec
**Why:** Relatable conflict + humor. Low skip rate potential ‚Äî viewers stay to hear both sides. The "who's right?" tension drives comments AND shares.

### Script 4: "Friendship Application Form"
**Hook:** *"the application to join our friend group just dropped"*
**Concept:** Fake form on screen with absurd requirements ‚Äî "must be willing to beat a dead horse," "references from at least 2 unhinged group chats," "must be available for 2am crisis calls"
**Caption:** "applications close never because we're not accepting new members"
**Duration:** 12‚Äì18 sec
**Why:** Short, punchy, rewatchable. Callbacks to your existing content ("dead horse" reference) reward your growing audience. High save potential ‚Äî people screenshot/save the "form."

### Script 5: "The Friend Who..."
**Hook:** *"every friend group has THE friend who‚Ä¶"*
**Concept:** Quick cuts labeling each friend in the group ‚Äî "the one who's always late," "the one who starts drama then watches," "the one who screenshots everything" ‚Äî each friend acts it out
**Caption:** "tag yourself, I already know which one you are"
**Duration:** 15‚Äì22 sec
**Why:** "Tag yourself" format is a proven share driver. Personalization triggers engagement ‚Äî people comment which one they are and send it to their group. This is the same mechanic behind your 69K shares.`;

const FALLBACK_VIRAL = `## Why Post 2 Went Viral (5.1M views) and Post 1 Flopped (30.8K)

The gap between these two posts is **165x**. Here's exactly what happened.

### The Hook Made People Stop Scrolling

**Post 2 hook:** *"us continuing to beat our dead horses into 2026"*
- Instantly funny ‚Äî "beat a dead horse" is a universally understood idiom
- Self-aware and casual ‚Äî doesn't try too hard
- Creates curiosity ‚Äî "what are the dead horses?"
- **Result: 31.1% skip rate** (28 points below your 59.1% average)

**Post 1 hook:** *"wanted to post this video here as appreciation"*
- Announces intent instead of hooking ‚Äî "I wanted to post this" is about you, not the viewer
- No curiosity gap ‚Äî the viewer already knows what's coming (appreciation content)
- Passive energy ‚Äî reads like a journal entry, not a reel
- **Result: 47.9% skip rate** and only **8 sec average watch time** out of 23 sec (34% retention)

### The Share Mechanic Was Completely Different

This is the real engine behind virality.

**Post 2:** 69,684 shares ‚Äî **43.5 shares per comment**
People didn't stop to type a comment. They immediately hit "send" to a friend or group chat. The humor was so relatable that the instinct was "this is literally us" ‚Üí forward.

**Post 1:** 382 shares ‚Äî **9.8 shares per comment**
Appreciation content is personal. People might like it, but they don't send it to friends because it's about *your* friendship, not *their* friendship.

**The key insight:** Your viral content makes the *viewer's* friendships the main character. Your low-performing content makes *your* friendships the main character. That one shift changes everything.

### The Algorithm Responded Differently

**Post 2:** 99.3% non-followers reached, 3.73M accounts reached, 1,105 new follows
The algorithm detected high share velocity early, pushed it to Explore and Reels feeds, and it snowballed. Non-follower reach of 99.3% means Instagram essentially treated this as a discovery-first piece of content.

**Post 1:** Stayed within your existing audience. No breakout distribution. The algorithm saw low retention (34%) and low shares, and throttled distribution early.

### Content Type Was the Deciding Factor

- **Post 2 (humor/relatable):** 5.1M views, 31.1% skip, 16 sec avg watch, 69K shares
- **Post 1 (sentimental/appreciation):** 30.8K views, 47.9% skip, 8 sec avg watch, 382 shares

Same creator. Same audience. Same platform. The only variable was content type. Humor won by 165x.

### How to Replicate This

- **Lead with a universal emotion**, not a personal diary entry. "Us continuing to beat our dead horses" = everyone has dead horses. "Wanted to post this as appreciation" = only you have this appreciation.
- **Optimize for shares, not likes.** Ask yourself before posting: "Would someone send this to their group chat?" If no, rewrite the hook.
- **Keep the callback loop going.** Post 3 (337K, "dead horse" v1) primed the audience. Post 2 (5.1M, "dead horse" v2) paid it off. Sequels compound when the first one lands.
- **Stay under 30 seconds** for humor content. Post 2 was 32 sec with 16 sec avg watch (50% retention). Post 1 was 23 sec with 8 sec avg watch (34%). The joke needs to land fast.`;

const FALLBACK_FIX = `## Diagnosing Post 1: What Went Wrong

**The post:** *"wanted to post this video here as appreciation..."*
**The stats:** 30,842 views ¬∑ 47.9% skip ¬∑ 8 sec avg watch ¬∑ 382 shares ¬∑ 237 saves

Compared to your viral hit (5.1M views), this underperformed by **165x**. Here's the breakdown.

### Problem 1: The Hook Announces Instead of Hooking

*"Wanted to post this video here as appreciation"* tells the viewer three things immediately:
1. This is about **you**, not them
2. It's sentimental (low energy for a scroll feed)
3. There's no mystery ‚Äî they know exactly what's coming

In the first 3 seconds, viewers decide to stay or swipe. This hook gives them no reason to stay. Compare to Post 2's hook: *"us continuing to beat our dead horses into 2026"* ‚Äî that's funny, unexpected, and makes you want to see what happens.

### Problem 2: 34% Watch-Through Rate

Viewers watched 8 seconds of a 23-second video. That's brutal. It means:
- The hook didn't earn enough attention to carry them past the first few seconds
- The content pacing was too slow for the format ‚Äî appreciation/montage content tends to feel like "more of the same" after the first few seconds
- The algorithm saw early drop-off and killed distribution

### Problem 3: No Share Trigger

382 shares with 30K views = **1.2% share rate**. Your viral post had a **1.4% share rate** but at 5.1M views ‚Äî and more importantly, a **43:1 share-to-comment ratio** vs Post 1's **9.8:1**.

Appreciation content is inherently personal. Viewers think "that's sweet" but don't feel compelled to send it to someone. There's no "this is literally us" moment.

### Problem 4: Low Save Rate

237 saves signals the content didn't deliver enough value or rewatchability. Saves tell the algorithm "this is worth coming back to." Without saves, Instagram has no reason to extend the content's shelf life.

## The Fix: Same Content, 10x Better

Here's how you take the exact same friendship appreciation concept and repackage it to perform:

### Rewrite Option A: "The Humor Wrapper"
**New hook:** *"how to tell your friends you love them without being weird about it"*
**Concept:** Quick cuts of increasingly absurd ways you show appreciation ‚Äî sending memes at 3am, roasting them publicly, showing up with food unannounced ‚Äî ending with genuine sweet moment
**Caption:** "romance is dead but friendship is thriving"
**Duration:** 15‚Äì18 sec
**Why it works:** Same appreciation message, but wrapped in humor. The hook creates a curiosity gap. The format is shareable ("tag someone you appreciate in the most unhinged way"). Ends with the emotional payoff without leading with it.

### Rewrite Option B: "The Bait-and-Switch"
**New hook:** *"things that would be toxic in a relationship but are normal in a friendship"*
**Concept:** Start with "not texting back for 3 days" / "ghosting plans last minute" / "brutal honesty about outfits" ‚Äî then flip to "but still showing up when it matters" with a genuine appreciation moment
**Caption:** "the bar is underground for romance but my friends clear it every time üò≠"
**Duration:** 18‚Äì22 sec
**Why it works:** Opens with a relatable/funny hook that earns attention, delivers the appreciation message as a payoff rather than a premise. High share potential ‚Äî people send this to the friends they "ghost but love."

### Rewrite Option C: "The List Format"
**New hook:** *"reasons I would never survive without my friends: a comprehensive list"*
**Concept:** Rapid-fire text overlays on clips ‚Äî mix of funny reasons ("they tell me when my outfit is bad") and real reasons ("they showed up when nobody else did") ‚Äî fast pacing, 2 sec per reason
**Caption:** "this is my formal thank you and also my formal apology for being a lot"
**Duration:** 12‚Äì15 sec
**Why it works:** List formats have natural pacing that fights skip behavior. Mixing humor and sincerity keeps viewers guessing what comes next. Short duration ensures high retention rate. The caption adds personality.

### The Core Lesson

Your audience doesn't reject appreciation ‚Äî they reject *boring hooks for appreciation*. Lead with humor, curiosity, or relatability. Let the sentiment be the reward at the end, not the promise at the start.`;

const FALLBACK_GENERIC = `## Content Performance Analysis

Here's what your data reveals across 3 posts spanning Nov 2025 ‚Äì Feb 2026.

### The Big Picture

Your content has a **massive variance problem** ‚Äî and that's actually good news. It means when you hit, you hit hard. The question is how to hit more consistently.

| | Post 1 (Low) | Post 3 (Mid) | Post 2 (Viral) |
|---|---|---|---|
| **Views** | 30.8K | 337K | 5.1M |
| **Skip Rate** | 47.9% | 47.6% | 31.1% |
| **Shares** | 382 | 13,527 | 69,684 |
| **Content Type** | Appreciation | Humor | Humor |

**The signal is clear:** humor and relatability content outperforms sentimental content by 10‚Äì165x.

### Your Strengths

- **Share-driven virality** ‚Äî your best content has an abnormally high share-to-comment ratio (43:1 on Post 2). This means your audience's instinct is to *forward* your content, not just engage with it. That's the most powerful growth mechanic on Instagram.
- **Franchise potential** ‚Äî the "dead horse" series went from 337K to 5.1M. You've proven that callback humor compounds over time.
- **Non-follower reach** ‚Äî Posts 2 and 3 both reached 99%+ non-followers. The algorithm trusts your humor content for discovery feeds.

### Your Growth Levers

- **Double down on humor/relatable** ‚Äî your data gives you permission to stop guessing. 80% of your content should be in this lane.
- **Optimize hooks ruthlessly** ‚Äî the difference between 31% and 48% skip rate is millions of views. Write 5 hooks for every video, pick the most curiosity-driven one.
- **Target the share reflex** ‚Äî before posting, ask: "would someone send this to a group chat?" If the answer isn't an obvious yes, rework the concept.
- **Keep building franchises** ‚Äî "dead horse" works. Create 2‚Äì3 more recurring formats you can return to.

### What to Avoid

- **Leading with sentiment** ‚Äî save emotional content for the payoff, not the hook
- **Diary-style captions** ‚Äî "wanted to post this" energy signals low-intent content to both viewers and the algorithm
- **One-off concepts** ‚Äî your best ROI comes from formats that can be repeated and remixed`;

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// Match user prompt to best fallback
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function getFallback(prompt) {
  const p = prompt.toLowerCase();
  if (p.includes('full') && p.includes('analysis') || (p.includes('diagnosis') && p.includes('script')))
    return FALLBACK_FULL;
  if (p.includes('script') || p.includes('write') || p.includes('generate'))
    return FALLBACK_SCRIPTS;
  if (p.includes('viral') || p.includes('why did') || p.includes('post 2') || p.includes('flop'))
    return FALLBACK_VIRAL;
  if (p.includes('fix') || p.includes('improve') || p.includes('post 1') || p.includes('underperform'))
    return FALLBACK_FIX;
  return FALLBACK_GENERIC;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// Main send function ‚Äî tries backend, falls
// back to local analysis if it fails
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function send() {
  const p = document.getElementById('prompt').value.trim();
  const err = document.getElementById('err');
  const btn = document.getElementById('btn');
  err.classList.remove('on');
  if (!p) { err.textContent = 'Type a question or pick a quick action.'; err.classList.add('on'); return; }

  btn.disabled = true;
  document.getElementById('placeholder-body').style.display = 'none';
  document.getElementById('loading').classList.add('on');
  document.getElementById('results').classList.remove('on');

  let i = 0;
  const iv = setInterval(() => { i = (i+1) % LMSGS.length; document.getElementById('ltxt').textContent = LMSGS[i]; }, 2200);

  // Simulate a brief "thinking" delay for fallback (feels more real)
  const minDelay = new Promise(r => setTimeout(r, 2800));

  let text = null;

  // Try backend first
  try {
    if (BACKEND_URL && !BACKEND_URL.includes('YOUR_N8N')) {
      const res = await fetch(BACKEND_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ question: p })
      });
      const data = await res.json();
      text = data.output || data.response || data.text || data.message || null;
    }
  } catch(e) {
    // Backend failed ‚Äî will use fallback
  }

  // Fallback to local analysis
  if (!text) {
    await minDelay;
    text = getFallback(p);
  }

  clearInterval(iv);
  document.getElementById('loading').classList.remove('on');
  document.getElementById('rbox').innerHTML = md(text);
  document.getElementById('results').classList.add('on');
  document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  btn.disabled = false;
}

const ta = document.getElementById('prompt');
ta.addEventListener('keydown', e => { if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) send(); });
</script>
</body>
</html>
